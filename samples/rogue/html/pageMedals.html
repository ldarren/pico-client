<style>
#medals{
    background:#527f39;
}
.medal{
    background:#204631;
    border-top:#527f39 5px solid;
}
.medal img{
    display:inline-block;
    padding:5px;
    vertical-align:top;
    max-width:128px;
    width:20%;
}
.medal div{
    display:inline-block;
    padding:5px;
    vertical-align:top;
    width:70%;
}
.medal h4{
}
.medal p{
}
.medal span:nth-of-type(1){
    display:block;
}
.medal span:nth-of-type(2){
    display:block;
}
</style>

<div class=pageHead>
<a href=#>&lt;&lt;</a>
<span>Medals</span>
</div>

<div id=medals>
</div>

<script id=medalTempl type=text/templ>
<img src="dat/img/medals/ID.png" width=SIZE>
<div>
<h4>NAME</h4>
<p>DESC</p>
<span>CURR/TOTAL</span>
<span>Unlock: REWARD</span>
</div>
</script>

<script name=medalPage>
var
me = this,
medalList = [
'won', 'fall', 'gold', 'piety', 'fame', 'plant','chest', 'common', 'charm', 'enchant', 'legendary', 'drink', 'learn', 
'insect', 'beast', 'undead', 'demon', 'def', 'patk', 'ratk', 'will', 'cast', 
'burn', 'curse', 'disease', 'fear', 'frozen', 'poison'],
onBack = function(evt){
    var hash = window.location.hash;
    if (!hash || '#me' === hash) pico.changeFrame(document.body, 'div#page', 'html/pageLogin.html', {opacity:[0,1,'1s']});
    else pico.changeFrame(document.body, 'div#page', 'html/pageMap.html', {opacity:[0,1,'1s']});
},
onLoad = function(){
    var 
    socials = me.socials,
    backBtn = document.querySelector('div.pageHead a'),
    medalCont = document.querySelector('div#medals'),
    templ = document.querySelector('script#medalTempl').textContent,
    size = window.innerWidth > 800 ? 128 : 64,
    medalId,medalEle;

    backBtn.addEventListener('click', onBack);

    medalCont.innerHTML = '';

    for(var i=0,l=medalList.length; i<l; i++){
        medalId = medalList[i];
        medalEle = document.createElement('div');
        medalEle.className = 'medal';
        medalEle.innerHTML = templ
                                .replace('ID', medalId)
                                .replace('SIZE', size)
                                .replace('NAME', G_MEDAL_GRADE[0] + G_MEDAL_NAME[medalId])
                                .replace('DESC', G_MEDAL_DESC[medalId])
                                .replace('CURR', '9999')
                                .replace('TOTAL', '9999')
                                .replace('REWARD', '1 Piety point');
        medalCont.appendChild(medalEle);
    }

    var id = window.location.hash.substring(1);
    socials.readMedals(id ? id : 'me', function(medals){
        console.dir(medals);
    });
};

me.use('socials');
me.use('god');

me.slot(pico.LOAD, onLoad);
</script>
