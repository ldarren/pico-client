<style>
.cssBtn {
    position:relative;
    -moz-box-shadow:inset 0px 1px 0px 0px #caefab;
    -webkit-box-shadow:inset 0px 1px 0px 0px #caefab;
    box-shadow:inset 0px 1px 0px 0px #caefab;
    background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #77d42a), color-stop(1, #5cb811) );
    background:-moz-linear-gradient( center top, #77d42a 5%, #5cb811 100% );
    filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#77d42a', endColorstr='#5cb811');
    background-color:#77d42a;
    -webkit-border-top-left-radius:0px;
    -moz-border-radius-topleft:0px;
    border-top-left-radius:0px;
    -webkit-border-top-right-radius:0px;
    -moz-border-radius-topright:0px;
    border-top-right-radius:0px;
    -webkit-border-bottom-right-radius:0px;
    -moz-border-radius-bottomright:0px;
    border-bottom-right-radius:0px;
    -webkit-border-bottom-left-radius:0px;
    -moz-border-radius-bottomleft:0px;
    border-bottom-left-radius:0px;
    text-indent:0;
    border:1px solid #268a16;
    display:inline-block;
    color:#306108;
    font-family:alagard, Arial;
    font-size:15px;
    font-weight:normal;
    font-style:normal;
    height:40px;
    line-height:40px;
    width:200px;
    text-decoration:none;
    text-align:center;
    text-shadow:1px 1px 0px #aade7c;
}
.cssBtn:hover {
    background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #5cb811), color-stop(1, #77d42a) );
    background:-moz-linear-gradient( center top, #5cb811 5%, #77d42a 100% );
    filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#5cb811', endColorstr='#77d42a');
    background-color:#5cb811;
}
.cssBtn:active {
    top:1px;
}
h3{
    margin: 10px auto;
    text-align:center;
    line-height:50px;
}
h4{
    margin: 0 auto 10px auto;
    text-align:center;
    line-height:20px;
}
ul.mainMenu{
    width:200px;
    margin: 10px auto;
}
ul.mainMenu li{
    display: block;
    list-style: none;
    margin: 10px auto;
}
ul.mainMenu li input[type=text]{
    line-height:30px;
    text-align:center;
    width:100%;
    height:30px;
}
.frame{
    max-width: 512px;
    color:#aec440;
    border: 3px solid #d7e894;
    border-radius: 15px;
    margin:5px auto;
    padding:5px;
    display:none;
}
.frame div{
    width:200px;
    margin: 10px auto;
}
div.fbProfile{
    display:inline-block;
    vertical-align:top;
    width: 90px;
    height: 100px;
    padding:5px;
}
div.fbProfile img{
    display:block;
    margin: 0 auto;
    padding:5px;
}
div.fbProfile span{
    display:block;
    width: 100%;
    text-align: center;
    padding:5px;
}
</style>

<div id=fb-root></div>

<h3>Dungeon Chronicles</h3>

<ul class=mainMenu>
<li><a href=# class=cssBtn>Connecting...</a></li>
<li><input type=text placeholder="Hero Name: Nameless"></input></li>
<li><input type=checkbox>Silence</input></li>
</ul>

<div id=ranking class=frame>
<h4>Friend Ranking</h4>
<content class=fbProfileList>Require facebook connect</content>
</div>

<div id=badges class=frame>
<h4>Badges</h4>
<span>Require facebook connect</span>
</div>

<div id=deviceSync class=frame>
<h4>Data Backup</h4>
<div><a href=# class=cssBtn>Google+ Connect</a></div>
</div>

<script id=fbScore type=text/templ>
<img src="https://graph.facebook.com/USER_ID/picture">
<span>NAME</span>
</script>

<script id=fbBadge type=text/templ>
<img src="https://graph.facebook.com/USER_ID/picture">
<span>NAME</span>
</script>

<script id=fbProfile type=text/templ>
<img src=PROFILE>
<span>NAME</span>
</script>

<script name=loginPage>
this.use('rogueMain');
this.use('piHTMLAudio');
this.use('socials');
this.use('game');

var
me = this,
playBtn, nameTextbox, 
onPlay = function(){
    me.piHTMLAudio.preload();
    me.rogueMain.showLoading();
    me.game.init(nameTextbox.value || 'Nameless');
    pico.changeFrame(document.body, 'div#page', 'html/pageGame.html', {opacity:[0,1,'1s']});
},
fbLogin = function(){ FB.login(null, {scope:''}); },
fbLogout = function(){ FB.logout(); },
fbUpdate = function(){
    var
    socials = me.socials,
    frames = document.getElementsByClassName('frame');

    for (var i=0,l=frames.length; i<l; i++){
        frames[i].style.display = 'block';
    }
    socials.fbFriends(100, function(friends){
        var
        list = document.querySelector('content.fbProfileList'),
        templ = document.querySelector('script#fbProfile').textContent,
        profile;

        list.innerHTML = '';

        for(var i=0,l=friends.length; i<l; i++){
            profile = document.createElement('div');
            profile.className = 'fbProfile';
            profile.innerHTML = templ
                .replace('PROFILE', socials.fbProfile(friends[i].id, 64))
                .replace('NAME', friends[i].name);
            list.appendChild(profile);
        }
    });
},
onFacebookUpdate = function(userId){
    playBtn.removeEventListener('click', fbLogin);
    playBtn.removeEventListener('click', onPlay);
    if (userId){
        playBtn.textContent = 'Begin';
        playBtn.addEventListener('click', onPlay, false);
    }else{
        playBtn.textContent = 'Login';
        playBtn.addEventListener('click', fbLogin, false);
    }
},
onLoad = function(){
    playBtn = document.querySelector('ul.mainMenu li:nth-child(1) a');
    nameTextbox = document.querySelector('ul.mainMenu li:nth-child(2) input');

    var name = me.game.load();
    if (name){
      nameTextbox.value = name;
    }

    me.piHTMLAudio.create('dat/fantasy-sfx.json', function(err, audioSprite){
        me.socials.loadFacebook(
            '515256841901768', 
            'Phonegap' === pico.states.browser ? CDV.FB : '//dungeon-chronicles.com/rogue/html/fbChannel.html',
            onFacebookUpdate);
        /* if no network */ me.rogueMain.hideLoading();
    });
};

me.slot(pico.LOAD, onLoad);
</script>
