{
    "deps":{
        "util":"api/util",
        "chat":"api/chat",
        "user":"api/user",
        "directory":"api/directory",
		"stream":"api/stream",
		"remote":"api/remote",
        "web":["context","webServer"]
    },      
    "routes":{
        "/glueon":[
            ["util","route","req"],
			["web","parse","req","res"]
        ],
		"/glueon/stream":[
			["web","SSEStart","req","res"],
            ["user","verify","cred","me"],
			["stream","prepare","cred","input","output"],
			["user","poll","cred","input","output"],
			["chat","poll","cred","input","output"],
			["directory","poll","cred","input","output"],
			["stream","add","res","cred"],
			["stream","render","res",["poll"],"output"]
		],
		"from/remote/user/getSession":[
			["util","have","cred",[["app","sess"]]],
			["util","have","input",[["id"]]],
			["remote","verify","cred"],
            ["util","randomStr",["$sessKey",20]],
            ["user","createSession","input","$sessKey","session"],
            ["user","replyPrivate","session"],
            []
		],
		"to/remote/user/read":[
			["remote","request","cred","input",["from/remote/user/read"],"user"],
			["user","update","user"],
            ["user","replyPrivate","user"],
			[]
		],
		"to/remote/directory/list":[
			["remote","request","cred","input",["from/remote/directory/list"],":dirs"],
			["directory","update","cred","input",":dirs"],
            ["directory","replyList",":dirs"],
			[]
		],
		"to/remote/directory/search":[
			["remote","request","cred","input",["from/remote/directory/search"],":dirs"],
			["directory","updatePublic","input",":dirs"],
            ["directory","replyList",":dirs"],
			[]
		],
		"to/remote/group/read":[
			["remote","request","cred","input",["from/remote/group/read"],"group"],
			["directory","updateGroup","input","group"],
            ["directory","replyPrivate","group"],
			[]
		],
		"to/remote/chat/read":[
			["remote","request","cred","input",["from/remote/group/read"],"group"],
			["directory","updateGroup","input","group"],
            ["directory","isExternal","cred","group",["$external"]],
            ["chat","$find","cred","input","$external","chat"],
            ["chat","read","chat"],
            ["chat","replyPrivate","chat"],
			[]
		],
		"ERR//glueon/stream":[
			["stream","render","res",["error"],"error"],
			["stream","remove","res"]
		],
        "ERR|#msg": [
			["util","logParams"],
            []
        ],
        "END|#msg": [
            [] 
        ],
        "glueon/user/signout":[
            ["user","verify","cred","me"],
            ["user","removeSession","cred"],
            []
        ],
        "glueon/user/update":[
            ["user","verify","cred","me"],
            ["user","update","cred","input","output"],
            ["user","replyPrivate","output"],
            []
        ],
        "glueon/user/list":[
            ["user","verify","cred","me"],
            ["user","list","input",":output"],
            ["user","replyList",":output"],
            []
        ],
        "glueon/user/read":[
            ["util","have","input",[["id"]]],
            ["user","verify","cred","me"],
            ["user","$read","cred","input","me","output"],
            ["user","reply","output"],
            []
        ],
		"glueon/directory/create":[
            ["util","have","input",[["name"]]],
            ["user","verify","cred","me"],
			["remote","request","cred","input",["from/remote/directory/create"],"dir"],
			["directory","update","cred","input",["d"],"dir"],
            ["directory","replyPrivate","dir"],
			[]
		],
		"glueon/directory/list":[
            ["util","have","input",[["grp","name"]]],
            ["user","verify","cred","me"],
            ["directory","$list","cred","input",":dirs"],
            ["directory","replyList",":dirs"],
			[]
		],
		"glueon/directory/search":[
            ["util","have","input",[["grp"]]],
            ["directory","$search","input",":dirs"],
            ["directory","replyList",":dirs"],
			[]
		],
		"glueon/group/read":[
            ["util","have","input",[["id"]]],
            ["user","verify","cred","me"],
            ["directory","$group","input","group",["to/remote/group/read"]],
            ["directory","replyPrivate","group"],
			[]
		],
		"glueon/chat/create":[
            ["util","have","input",[["id"]]],
            ["user","verify","cred","me"],
            ["chat","create","cred","input","$external","chat"],
            ["chat","replyPrivate","chat"],
			[]
		],
		"glueon/chat/read":[
            ["util","have","input",[["id"]]],
            ["user","verify","cred","me"],
            ["directory","$group","input","group",["to/remote/chat/read"]],
            ["directory","isExternal","cred","group",["$external"]],
            ["chat","$find","cred","input","$external","chat"],
            ["chat","read","chat"],
            ["chat","replyPrivate","chat"],
			[]
		],
        "#help": [
            ["util","help"] 
        ] 
    }
}   
